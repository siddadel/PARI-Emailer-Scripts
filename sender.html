
<!DOCTYPE html>

<html>
  <head>
    <base target="_top">
    <!-- Include the Google CSS package -->
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons.css">
  </head>
 
    <!-- You can also include your own CSS styles -->
   <style>
     form { margin: 40px auto; }
     input { display:block; margin: 20px; }
   </style>
  
    <body>

       <h1>Send Emails to a list of email ids</h1>
       <!-- This is the actual HTML form -->
       <form id="myForm">
      
       <!-- Text input field -->
       Please upload the newsletter in HTML file form.
       <input type="file" name="htmlFile"><br>
       Please enter the URL of the Google Spreadsheet that contains the list of email ids
       <input type="text" name="sheet"><br>
       Please enter the column number which has the emails
       <input type="number" name="column"><br>   
       Please enter the row number of the entry in the spreadsheet <b>FROM</b> which we should start sending
       <input type="number" name="from"><br>     
       Please enter the row number of the entry in the spreadsheet <b>TO</b> which we should start sending
       <input type="number" name="to"><br>     
       Subject of the email
       <input type="text" name="subject"><br>
       
       <!-- The submit button. It calls the server side function uploadfiles() on click -->
       <input type="submit" value="Send Emails" 
       onclick="this.value='Sending..';
       google.script.run.withSuccessHandler(fileUploaded)
       .send(this.parentNode);
       return false;">
      </form>  
      <!-- Here the results of the form submission will be displayed -->
      <div id="output"></div>
 
      <!-- The function will be called after the Google Script has executed -->
      <script>
        function fileUploaded(status) {
          document.getElementById('myForm').style.display = 'none';
          document.getElementById('output').innerHTML = status;
       }
      </script>
  </body>
</html>


